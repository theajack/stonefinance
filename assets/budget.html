<!doctype html>
<html lang="zh-Hans">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta http-equiv="Cache-Control" content="no-siteapp" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no, email=no">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-tap-highlight" content="no">
    <title></title>
    <link rel="stylesheet" href="css/style.css?v=1">
    <link rel="stylesheet" href="css/base.min.css">
    <link rel="stylesheet" href="css/plugin.min.css">
  </head>
  <body class="bg-white">
    <div id="userCenter" class="display-none">     
      <div class="user-head">
        <img src="images/logo3.png" class="center-photo"/>
      </div>
      <div id="userCenterWrapper">
        <div class="mt-md">
          <label class="common-lable">
          <span>账号</span>
          ：</label>
          <input id="memberAccount" type="text" data-valid="notnull" placeholder="账号" disabled="disabled"/>
        </div>
        <form id="userCenterForm">
          <div class="mt-md">
            <label class="common-lable">
            <span>密码</span>
            <span class="notice-mark">*</span>：</label>
            <input class="common-input" type="password" data-name="password" data-valid="notnull" id="passWord" placeholder="密码" disabled="disabled"/>
          </div>
          <div class="mt-md">
            <label class="common-lable">
            <span>姓名</span>
            ：</label>
            <input class="common-input" type="text" data-name="membername"  placeholder="姓名" disabled="disabled"/>
          </div>
          <div class="position-relative">
            <div class="disabled-div display-none" id="disabledDiv"></div>
            <div class="mt-md">
              <label class="common-lable">
              <span>出生年月</span>
              ：</label>
              <input class="common-input" type="text" data-name="memberbir" id="memberBir" data-valid="datetime" placeholder="出生年月" disabled="disabled"/>
            </div>
          </div>
          <div class="mt-md">
            <label class="common-lable">
              <span>性别</span>
            ：</label>
            <span class="ml-lg">
              <label class="sex-select" for="female">女</label>
              <input class="radio-select" type="radio" name="membersex" id="female" disabled="disabled" onClick="changeSex('0')"/>
              <label class="sex-select" for="male">男</label>
              <input class="radio-select" type="radio" name="membersex" id="male" disabled="disabled" onClick="changeSex('1')"/>
              <input type="text" data-name="membersex" id="memberSex" class="display-none"/>
            </span>
          </div>
          <div class="mt-md">
            <label class="common-lable">
            <span>电话</span>
            ：</label>
            <input class="common-input" type="text" data-name="membertele" data-valid="phone" placeholder="电话" disabled="disabled"/>
          </div>
          <div class="mt-md mb-md">
            <label class="common-lable">
            <span>密保问题</span>
            ：</label>
            <input class="common-input" type="text" data-name="question" placeholder="密保问题" disabled="disabled"/>
          </div>
          <div class="mt-md mb-md">
            <label class="common-lable">
            <span>密保答案</span>
            ：</label>
            <input class="common-input" type="text" data-name="answer" placeholder="密保答案" disabled="disabled"/>
          </div>
        </form>
        <div class="edit-button" id="editBtn" onclick="editInfo()">编辑</div>
        <div class="edit-button display-none" id="finishBtn" onClick="updateUserData()">完成</div>
      </div>
    </div>
    <div id="allContent">
      <div class="head-wrapper">
        <div class="head-inside div-center text-center">
          <img src="images/logo3.png" class="height-full"/>
          <span class="page-title">收支预算</span>
          <a href="addbudget.html"><span class="glyphicon glyphicon-plus add-button"></span></a>
          <span class="user-photo glyphicon glyphicon-user" onclick="showCenterPage()"></span>
        </div>
      </div> 
      <div class="swiper-container" id="swiperPagesBudget">
        <div class="swiper-scrollbar">
          <div class="swiper-scrollbar-drag swiper-scrollbar-cursor-drag"></div>
        </div>
        <div class="swiper-wrapper">
          <div class="swiper-slide">
            <form id="searchForm">
              <div class="p-sm clearfix set-shadow">
                <div class="statistics-left">
                  <input class="statistics-date" data-name="starttime" id="startDate"/>
                  <span class="time-line"></span>
                  <input class="statistics-date" data-name="endtime" id="endData"/>
                    <!--<input type="" id="inConsume">全部用户</span>-->
                  <div class="statistics-date mt-sm mr-sm" id="chartType" onclick="selectType(this)">
                    <span id="titleInfo">全部预算</span>
                    <input class="display-none" value="全部预算" data-name="searchtype"/>
                    <span class="glyphicon glyphicon-chevron-down list-type-arrow theme-color"></span>
                  </div>
                  <div class="list-type-select statistics-option">
                    <div class="text-center" onClick="changeSearchType(this,6)">全部预算</div>
                    <div class="text-center border-top-ddd" onClick="changeSearchType(this,0)">单人支出</div>
                    <div class="text-center border-top-ddd"  onClick="changeSearchType(this,1)">单人收入</div>
                    <div class="text-center border-top-ddd" onClick="changeSearchType(this,2)">成员支出</div>
                    <div class="text-center border-top-ddd"  onClick="changeSearchType(this,3)">成员收入</div>   
                    <div class="text-center border-top-ddd" onClick="changeSearchType(this,4)">收入类型</div>
                    <div class="text-center border-top-ddd"  onClick="changeSearchType(this,5)">支出类型</div>
                  </div>
                  <input type="text" class="statistics-date mt-sm" id="consume" data-name="consumetype" readonly="true" onClick="showConsume()"/>
                </div>
                <div class="statistics-right">
                  <div class="statistics-inner">
                    <div class="statistics-split left detail-list bg-gray" id="budgetLists" onClick="changeDataShowType('list')">
                      <span class="glyphicon glyphicon-th-list" class="statistics-logo"></span>
                    </div>
                    <div class="statistics-split border-right" id="pieChart" onClick="changeDataShowType('pie')">
                      <img src="images/pie.jpg" class="statistics-logo"/>
                    </div>
                    <div class="statistics-split right" id="columnChart" onClick="changeDataShowType('column')">
                      <img src="images/column.jpg" class="statistics-logo"/>
                    </div>
                  </div>
                  <input class="statistics-date search-btn" type="button" onclick="searchBtn()" value="搜索"/>
                </div>
              </div>
            </form>
            <div class="swiper-slide width-full" id="budgetDiv">
             
            </div> 
            <div id="container" class="budget-chart">
            
            </div>          
          </div>
        </div>
      </div>
      <div id="footer">
        <a href="index.html">
          <div class="footer-item">
            <div class="div-center text-center footer-content mt-xs">
              <img src="images/mingxi.png"/>
              <div class="footer-text">明细报表</div>
            </div>
          </div>
        </a>
        <a href="#">
          <div class="footer-item">
            <div class="div-center text-center footer-content mt-xs">
              <img src="images/yusuan2.png" />
              <div class="footer-text theme-color">收支预算</div>
            </div>
          </div>
        </a>
        <a href="analysis.html">
          <div class="footer-item">
            <div class="div-center text-center footer-content mt-xs">
              <img src="images/search.png"/>
              <div class="footer-text">搜索分析</div>
            </div>
          </div>
        </a>
        <a href="manage.html">
          <div class="footer-item">
            <div class="div-center text-center footer-content mt-xs">
              <img src="images/guanli.png"/>
              <div class="footer-text">管理维护</div>
            </div>
          </div>
        </a>
      </div> 
    </div>
      </div>
    <div class="sztype-content display-none" id="consumeInWrapper" data-aim="consume">
      <div class="content-wrapper">
        <div class="content-head">收入成员</div>
        <span class="glyphicon glyphicon-remove close-btn" onClick="closePage(this)"></span>
        <div class="swiper-container" id="swiperInConsume">
          <div class="swiper-wrapper width-full">
            <div class="swiper-slide width-full">
              <div id="inConsumeContent" class="width-full">

              </div>
            </div>
          </div>  
        </div>
      </div>
    </div>
    <div class="sztype-content display-none" id="consumePayWrapper" data-aim="consume">
      <div class="content-wrapper">
        <div class="content-head">支出成员</div>
        <span class="glyphicon glyphicon-remove close-btn" onClick="closePage(this)"></span>
        <div class="swiper-container" id="swiperPayConsume">
          <div class="swiper-wrapper width-full">
            <div class="swiper-slide width-full">
              <div id="payConsumeContent" class="width-full">

              </div>
            </div>
          </div>  
        </div>
      </div>
    </div>
    
    <div class="sztype-content display-none" id="inTypeWrapper" data-aim="consume">
      <div class="content-wrapper">
        <div class="content-head">收入大类</div>
        <span class="glyphicon glyphicon-remove close-btn" onClick="closePage(this)"></span>
        <div class="swiper-container" id="swiperInType">
          <div class="swiper-wrapper width-full">
            <div class="swiper-slide width-full">
              <div id="inContent" class="width-full">

              </div>
            </div>
          </div>  
        </div>
      </div>
    </div>
    <div class="sztype-content display-none" id="payTypeWrapper" data-aim="consume">
      <div class="content-wrapper">
        <div class="content-head">支出成员</div>
        <span class="glyphicon glyphicon-remove close-btn" onClick="closePage(this)"></span>
        <div class="swiper-container" id="swiperPayType">
          <div class="swiper-wrapper width-full">
            <div class="swiper-slide width-full">
              <div id="bigPayContent" class="width-full">

              </div>
            </div>
          </div>  
        </div>
      </div>
    </div>
    
    <div class="cover-div display-none" onClick="closeCenterPage()"></div>
    <script src="js/plugin.min.js"></script>
    <script src="js/common.js"></script>
    <script src="js/HighCharts/highcharts.js" type="text/javascript"></script>
    <script src="js/HighCharts/highcharts-3d.js" type="text/javascript"></script>
    <script src="js/HighCharts/highcharts-3d.src.js" type="text/javascript"></script>
    <!-- 添加主题样式js文件 -->  
    <script src="js/HighCharts/themes/grid.js" type="text/javascript"></script>
    <!--添加导出模式 -->  
    <script src="js/HighCharts/modules/exporting.js" type="text/javascript"></script>
    <script type="text/javascript">
        var budget1 = [{"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"工资薪水","incometypeid":"1","budgetszclassify":"1","budgetmoney":"1600","consumename":"自己","memberaccount":"萍","bigpaytypeid":"","budgetid":"3"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"红包","incometypeid":"10","budgetszclassify":"1","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"","budgetid":"4"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"购物","incometypeid":"","budgetszclassify":"0","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"3","budgetid":"7"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"交通","incometypeid":"","budgetszclassify":"0","budgetmoney":"666","consumename":"家庭公用","memberaccount":"萍","bigpaytypeid":"2","budgetid":"8"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"红包","incometypeid":"10","budgetszclassify":"1","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"","budgetid":"4"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"购物","incometypeid":"","budgetszclassify":"0","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"3","budgetid":"7"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"交通","incometypeid":"","budgetszclassify":"0","budgetmoney":"666","consumename":"家庭公用","memberaccount":"萍","bigpaytypeid":"2","budgetid":"8"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"红包","incometypeid":"10","budgetszclassify":"1","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"","budgetid":"4"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"购物","incometypeid":"","budgetszclassify":"0","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"3","budgetid":"7"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"交通","incometypeid":"","budgetszclassify":"0","budgetmoney":"666","consumename":"家庭公用","memberaccount":"萍","bigpaytypeid":"2","budgetid":"8"},
        {"budgetmark":"你好","budgettimepart":"2016-05-01","budgetname":"医疗药品","incometypeid":"","budgetszclassify":"0","budgetmoney":"16","consumename":"配偶","memberaccount":"萍","bigpaytypeid":"3","budgetid":"16"}]; 
      var inConsume1 = [{"consumeszclassify":1,"consumename":"自己收入"},
      {"consumeszclassify":1,"consumename":"自己收入"},
      {"consumeszclassify":1,"consumename":"自己收入"}]; 
            var payConsume1 = [{"consumeszclassify":1,"consumename":"自己收入"},
      {"consumeszclassify":1,"consumename":"自己收入"},
      {"consumeszclassify":1,"consumename":"自己收入"}]; 
      var budgetList1 = [{"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"工资薪水","incometypeid":"1","budgetszclassify":"1","budgetmoney":"1600","consumename":"自己","memberaccount":"萍","bigpaytypeid":"","budgetid":"3"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"红包","incometypeid":"10","budgetszclassify":"1","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"","budgetid":"4"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"购物","incometypeid":"","budgetszclassify":"0","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"3","budgetid":"7"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"交通","incometypeid":"","budgetszclassify":"0","budgetmoney":"666","consumename":"家庭公用","memberaccount":"萍","bigpaytypeid":"2","budgetid":"8"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"红包","incometypeid":"10","budgetszclassify":"1","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"","budgetid":"4"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"购物","incometypeid":"","budgetszclassify":"0","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"3","budgetid":"7"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"交通","incometypeid":"","budgetszclassify":"0","budgetmoney":"666","consumename":"家庭公用","memberaccount":"萍","bigpaytypeid":"2","budgetid":"8"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"红包","incometypeid":"10","budgetszclassify":"1","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"","budgetid":"4"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"购物","incometypeid":"","budgetszclassify":"0","budgetmoney":"600","consumename":"孩子","memberaccount":"萍","bigpaytypeid":"3","budgetid":"7"},
        {"budgetmark":"","budgettimepart":"2016-05-01","budgetname":"交通","incometypeid":"","budgetszclassify":"0","budgetmoney":"666","consumename":"家庭公用","memberaccount":"萍","bigpaytypeid":"2","budgetid":"8"},
        {"budgetmark":"你好","budgettimepart":"2016-05-01","budgetname":"医疗药品","incometypeid":"","budgetszclassify":"0","budgetmoney":"16","consumename":"配偶","memberaccount":"萍","bigpaytypeid":"3","budgetid":"16"}];  
      
      var  budget,
          inConsume,
          payConsume,
          budgetList;
      $(function(){
        initHeight();
        initDate();
        allBudgetList();
        initDataPost();
        showDataList("inConsumeContent",inConsume,type_inConsume);
        showDataList("payConsumeContent",payConsume,type_payConsume);
      });
      function initDataPost(){
        bindUserData(); 
        inConsume = postData("showInConsume");
        payConsume = postData("showPayConsume");
      }
      function initDate(){
        bindYearMonth("startDate");
        $("#startDate").val(formatDate("noDay"));     
        bindYearMonth("endData");
        $("#endData").val(nowMonthAddOne());
      }
      function initHeight(){
        var swiperInitHeight = parseInt(winHeight) - headHeight - footerHeight - 96;
        $("#swiperPagesBudget").css("height",swiperPageHeight+"px");
        $("#budgetDiv").css("height",swiperInitHeight+"px");
        $("#userCenterWrapper").css("height",(winHeight-110)+"px");
        $("#container").css("height",(swiperInitHeight-30)+"px");
      }
      var isSelInComsume=false;
      function showConsume(){
        if(isSelInComsume){
          wrapperRaise("consumeInWrapper");
          initSwiper('swiperInConsume');
        }else{
          wrapperRaise("consumePayWrapper");
          initSwiper('swiperPayConsume');
        }
      }
      function allBudgetList(){
        $("#consume").val("全部预算").attr("onclick",null);//初始化
        $("#budgetLists").attr("onClick",null).addClass("bg-gray");
        $("#pieChart").attr("onclick",null).removeClass("bg-gray");
        $("#columnChart").attr("onclick",null).removeClass("bg-gray");
        $("#container").addClass("display-none");
        $("#budgetDiv").removeClass("display-none");
        var data=getFormVal("searchForm");
        budgetList = postData("allBudgetList",data);
        showBudget(budgetList);
      }
      function changeDataShowType(type){
        $("#budgetLists").removeClass("bg-gray");
        $("#pieChart").removeClass("bg-gray");
        $("#columnChart").removeClass("bg-gray");
        $("#container").addClass("display-none");
        $("#budgetDiv").addClass("display-none");
        selectFunction(type);
      }
      function selectFunction(type){
        var titleInfo = $("#titleInfo").text();
        switch (type){
          case "list":$("#budgetDiv").removeClass("display-none");
                      $("#budgetLists").addClass("bg-gray");
                      getSearchData(type);
                      showBudget(budget);break;
          case "pie":$("#container").removeClass("display-none");
                    $("#pieChart").addClass("bg-gray");
                    getSearchData(type);
                    createChart("container","pie",titleInfo,titleInfo);;
                    var dataWrapper = getSeriesData(budget);
                    setChartData(dataWrapper);
                    setSearchTitle();break;
          case "column":$("#container").removeClass("display-none");
                    $("#columnChart").addClass("bg-gray");
                    getSearchData(type);
                    createChart("container","column",titleInfo,titleInfo);
                    var dataWrapper = getSeriesData(budget);
                    setChartData(dataWrapper);
                    setSearchTitle();break;
        }
      }

      function setSearchTitle(){
        var titleInfo = $("#titleInfo").text();
        var consumename = $("#consume").val();
        var titleText;
        switch (titleInfo){
          case "单人支出":titleText = consumename+"-支出";xAxisTitle = "支出类型";break;
          case "单人收入":titleText = consumename+"-收入";xAxisTitle = "收入类型";break;
          case "成员支出":titleText = "全部成员-支出";xAxisTitle = "成员类型";break;
          case "成员收入":titleText = "全部成员-收入";xAxisTitle = "成员类型";break;
          case "收入类型":titleText = "全部类型-收入";xAxisTitle = "收入类型";break;
          case "支出类型":titleText = "全部类型-收入";xAxisTitle = "支出类型";break;
        }
        setChartTitle(titleText,xAxisTitle);
      }
      function getSearchData(type){
        var data=getFormVal("searchForm");
        data["type"] = type;
        budget = postData("searchAllBudget",data);
      }
      function searchBtn(){
        if($("#titleInfo").text()=="全部预算"){
          allBudgetList();
        }else{
          var type;
          if($("#budgetLists").hasClass("bg-gray")){
            type = "list";
          }else{
            if($("#pieChart").hasClass("bg-gray")){
              type = "pie";
            }else{
              type = "column";
            }
          }
          selectFunction(type);
        }
      }
      function showBudget(budget){
        $("#budgetDiv").empty();
        showDataList("budgetDiv",budget,type_budget);
      }
      // 选择人员类型
      function changeSearchType(obj,i){
        $("#budgetLists").attr("onClick","changeDataShowType('list')");
        $("#pieChart").attr("onclick","changeDataShowType('pie')");
        $("#columnChart").attr("onclick","changeDataShowType('column')");
        $(obj).parent().slideUp();
        $(obj).parent().prev().children().eq(0).text($(obj).text());
        $(obj).parent().prev().children().eq(1).val($(obj).text());
        switch(i){
          case 0:isSelInComsume=false;
          $("#consume").val(payConsume[0].consumename).attr("onclick","showConsume()");break;
          case 1:isSelInComsume=true;
          $("#consume").val(inConsume[0].consumename).attr("onclick","showConsume()");break;
          case 2:$("#consume").val("全部成员");$("#consume").attr("onclick",null);break;
          case 3:$("#consume").val("全部成员");$("#consume").attr("onclick",null);break;
          case 4:$("#consume").val("全部类型");$("#consume").attr("onclick",null);break;
          case 5:$("#consume").val("全部类型");$("#consume").attr("onclick",null);break;
        }
      }
    </script>
  </body>
</html>